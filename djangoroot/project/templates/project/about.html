{% extends "base.html" %}
{% load staticfiles %}
{% block content %}
<h1>About page</h1>

<script src="{% static 'project/js/d3.min.js' %}"></script>
<script src="{% static 'project/js/dc.min.js' %}"></script>
<script src="{% static 'project/js/crossfilter.min.js' %}"></script>

<link rel="stylesheet" type="text/css" href="{% static 'project/css/dc.css' %}" media="screen" />

<div id="chart-line-hitsperday" style="margin-top:20px;"></div>

<script>
var data = [
{% for stat in coin_stats %}
{date: "{{stat.created|date:'m/d/Y'}}", value:{{stat.value}}}{% if not forloop.last %},{% endif %}
{% endfor %}
];

var ndx = crossfilter(data);
var parseDate = d3.time.format("%m/%d/%Y").parse;
data.forEach(function(d) {
	d.date = parseDate(d.date);
});

var dateDim = ndx.dimension(function(d) {return d.date;});
var hits = dateDim.group().reduceSum(dc.pluck('value'));

var minDate = dateDim.bottom(1)[0].date;
var maxDate = dateDim.top(1)[0].date;

var hitslineChart  = dc.lineChart("#chart-line-hitsperday");
hitslineChart
	.width(600).height(300)
	.dimension(dateDim)
	.group(hits)
    .renderDataPoints(true)
    .renderArea(true)
    .brushOn(false)
    .y(d3.scale.linear().domain([0,3]))
    .yAxisLabel("H to USD")
	.x(d3.time.scale().domain([minDate,maxDate]));

hitslineChart.xAxis().tickFormat(function(d) {
    return d3.time.format('%m/%d/%y')(new Date(d))
});

hitslineChart.xAxis().ticks(5)

dc.renderAll();

</script>

{% endblock %}